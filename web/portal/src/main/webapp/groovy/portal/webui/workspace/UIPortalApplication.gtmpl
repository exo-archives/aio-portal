<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
           "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<%
	import org.exoplatform.webui.core.UIComponent;
	
  def rcontext = _ctx.getRequestContext() ;
  String docBase =  rcontext.getRequestContextPath() ;  
  String skin = uicomponent.getSkin();
  def portalSkins = uicomponent.getPortalSkins() ;
  def portletSkins = uicomponent.getPortletSkins() ;
  def scriptsPaths = uicomponent.getJavascriptURLs();
%>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head id="head">
    <title>eXo Portal</title>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <link rel="shortcut icon" type="image/x-icon"  href="/portal/favicon.ico" />
    <%for(skinConfig in portalSkins) {%>
      <link id="${skinConfig.id}" rel="stylesheet" type="text/css" href="$skinConfig.CSSPath" />
    <%}%>
    <%for(portletSkin in portletSkins) {%>
      <link id="${portletSkin.id}" rel="stylesheet" type="text/css" href= "$portletSkin.CSSPath" />
    <%}%>
    <%if("true".equals(System.getProperty("exo.product.developing"))) {
        for(path in scriptsPaths) { %>
          <script type="text/javascript" src="<%=path%>"></script>
    <%  }
      } else {
    %>
        <script type="text/javascript" src="/portal/javascript/merged.js"></script>
    <%}%>
    <script type="text/javascript">
      eXo.env.portal.context = '<%=docBase%>' ;
      <%if(rcontext.getAccessPath() == 0) {%>
          eXo.env.portal.accessMode = 'public' ;
      <%} else {%>
          eXo.env.portal.accessMode = 'private' ;
      <%}%>
      eXo.env.portal.portalName = '<%=rcontext.getPortalOwner()%>' ;
      eXo.env.server.context = '<%=docBase%>' ;
      eXo.env.server.portalBaseURL = '<%=rcontext.getURLBuilder().getBaseURL()%>' ;
      eXo.env.client.skin = '$skin' ;
    </script>
  </head>

  <body style="!height: 100%;">
    <% 
      /*Hide All Popup Menu when click on document*/
      rcontext.getJavascriptManager().addOnLoadJavascript('eXo.core.DOMUtil.hideElements');
      //rcontext.getJavascriptManager().addOnResizeJavascript('eXo.core.UIMaskLayer.resizeMaskLayer');
    %>
    
	<div class="$uicomponent.skin" id="UIPortalApplication" style="!height: 100%;">
    	
		<div class="AjaxLoadingMask" id="AjaxLoadingMask" style="display: none; margin: auto;">
      <div class="LoadingContainer">
        <div class="CenterLoadingContainer">
          <div class="LoadingText"><%=_ctx.appRes("UIPortalApplication.label.Loading")%></div>
          <div class="LoadingProgressBar"><span></span></div>
          
          <div class="UIAction"> 
				    <table class="ActionContainer" align="center">
					    <tr>
					    	<td align="center">
						      <a href="javascript:ajaxAbort();" class="ActionButton LightBlueStyle">
						        <div class="ButtonLeft">
						          <div class="ButtonRight">
						            <div class="ButtonMiddle">
						              <%=_ctx.appRes("UIPortalApplication.label.Abort")%>
						            </div>
						          </div>
						        </div>
						      </a>
						    </td>
				      </tr>
				 	  </table>
					</div>
          
        </div>
      </div>
	  </div>
	    
	  <%uicomponent.renderChildren();%>
	</div>
    

    
    <script type="text/javascript">
      <%=rcontext.getJavascriptManager().getJavascript()%>
        eXo.core.Browser.onLoad();
      <%=rcontext.getJavascriptManager().getCustomizedOnLoadScript();%>
    </script>
  </body>
</html>
